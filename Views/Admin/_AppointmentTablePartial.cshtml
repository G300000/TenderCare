@using Project.Models
@model IEnumerable<Project.Models.Appointment>

<div class="table-responsive">
    <table class="table" style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="text-align: left; border-bottom: 2px solid #eee; color: #7f8c8d;">
                <th style="padding: 15px;">ID</th>
                <th style="padding: 15px;">Patient Name</th>
                <th style="padding: 15px;">Service</th>
                <th style="padding: 15px;">Date</th>
                <th style="padding: 15px; text-align: center;">Actions</th>
            </tr>
        </thead>
        <tbody>
            @if (Model == null || !Model.Any())
            {
                <tr>
                    <td colspan="5" style="padding: 40px; text-align: center; color: #95a5a6; font-size: 1.1rem;">
                        No records found in this category.
                    </td>
                </tr>
            }
            else
            {
                @foreach (var item in Model)
                {
                    <tr style="border-bottom: 1px solid #f9f9f9; vertical-align: middle;">
                        <td style="padding: 15px; font-weight: 600;">@item.AppointmentID</td>

                        <td style="padding: 15px;">
                            <a asp-action="PatientDetails" asp-controller="Admin" asp-route-id="@item.PatientID"
                               style="color: #3498db; text-decoration: none; font-weight: 600;">
                                @item.Patient?.PatientName
                            </a>
                        </td>

                        <td style="padding: 15px;">@item.ServiceType</td>
                        <td style="padding: 15px;">@item.AppointmentDate?.ToString("MMM dd, yyyy")</td>

                        <td style="padding: 15px; text-align: center;">
                            <div style="display: flex; gap: 8px; justify-content: center; align-items: center;">

                                @if (item.Status == "Scheduled" || string.IsNullOrEmpty(item.Status))
                                {
                                    <form asp-action="Complete" asp-route-id="@item.AppointmentID" method="post" style="margin:0;">
                                        <button type="submit" class="btn-action" title="Mark as Completed"
                                                style="background: #2ecc71; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">
                                            <i class="fas fa-check"></i>
                                        </button>
                                    </form>
                                    <form asp-action="Cancel" asp-route-id="@item.AppointmentID" method="post" style="margin:0;">
                                        <button type="submit" class="btn-action" title="Cancel Appointment"
                                                style="background: #e74c3c; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </form>
                                }
                                else
                                {
                                    <form asp-action="Reschedule" asp-route-id="@item.AppointmentID" method="post" style="margin:0;">
                                        <button type="submit" class="btn-action" title="Restore to Scheduled"
                                                style="background: #3498db; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">
                                            <i class="fas fa-redo"></i> Restore
                                        </button>
                                    </form>
                                }

                                <a asp-action="Update" asp-route-id="@item.AppointmentID"
                                   style="background: #f1c40f; color: #000; padding: 8px 12px; border-radius: 6px; text-decoration: none; font-size: 0.9rem;">
                                    <i class="fas fa-edit"></i>
                                </a>

                                <form asp-action="Delete" asp-controller="Admin" asp-route-id="@item.AppointmentID" method="post" onsubmit="return confirm('Are you sure you want to delete this permanently?');" style="margin:0;">
                                    @Html.AntiForgeryToken()
                                    <button type="submit" style="background: #34495e; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>